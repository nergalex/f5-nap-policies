{
   "policy": {
      "name": "known_bot_only",
      "description": "Based on NGINX App Protect API Security template Policy",
      "enforcementMode": "blocking",
      "applicationLanguage": "utf-8",
      "template": {
         "name": "POLICY_TEMPLATE_NGINX_BASE"
      },
      "server-technologies": [
         {
            "serverTechnologyName": "Unix/Linux"
         },
         {
            "serverTechnologyName": "Nginx"
         },
         {
            "serverTechnologyName": "Apache/NCSA HTTP Server"
         },
         {
            "serverTechnologyName": "PHP"
         },
         {
            "serverTechnologyName": "JavaScript"
         },
         {
            "serverTechnologyName": "PostgreSQL"
         }
      ],
      "bot-defense": {
         "settings": {
            "isEnabled": true
         },
         "mitigations": {
            "classes": [
               {
                  "name": "trusted-bot",
                  "action": "detect"
               },
               {
                  "name": "untrusted-bot",
                  "action": "detect"
               },
               {
                  "name": "malicious-bot",
                  "action": "alarm"
               }
            ]
         }
      },
      "response-pages": [
         {
            "responseContent": "<html><head><title>Known bot only</title></head><body><h1>Blocking page</h1><br><br>Support = <%TS.request.ID()%></body></html>",
            "responseHeader": "HTTP/1.1 200 OK\r\nConnection: close",
            "responseActionType": "custom",
            "responsePageType": "default"
         }
      ],
      "whitelist-ips": [
         {
            "blockRequests": "always",
            "ipAddress": "1.1.1.1",
            "ipNetmask": "255.255.255.255"
         }
      ]
   }
}